# api β€” AI Inference API Server

`api/` λ””λ ‰ν† λ¦¬λ” λ³Έ ν”„λ΅μ νΈμ—μ„ **AI μ¶”λ΅  κΈ°λ¥μ„ μ™Έλ¶€μ— μ„λΉ„μ¤ ν•νƒλ΅ μ κ³µν•λ” API μ„λ²„**λ¥Ό λ‹΄λ‹Ήν•λ‹¤.

λ“λ΅ /CCTV λ“±μΌλ΅λ¶€ν„° μ „λ‹¬λλ” μ΄λ―Έμ§€(λλ” μμƒ ν”„λ μ„)μ— λ€ν•΄  
AI λ¶„μ„μ„ μν–‰ν•κ³ , κ·Έ κ²°κ³Όλ¥Ό **ν‘μ¤€ν™”λ JSON μ‘λ‹µ**μΌλ΅ λ°ν™ν•λ” κ²ƒμ΄ μ£Όλ μ—­ν• μ΄λ‹¤.

---

## π“ λ””λ ‰ν† λ¦¬ μ—­ν•  μ”μ•½

- AI μ¶”λ΅  μ”μ²­μ„ **HTTP API** ν•νƒλ΅ μμ‹ 
- μ¶”λ΅  κ²°κ³Όλ¥Ό **κ΄€μ  μ‹μ¤ν…μ΄ μ‚¬μ© κ°€λ¥ν• κµ¬μ΅°ν™”λ λ°μ΄ν„°**λ΅ λ°ν™
- μ‹¤μ  AI λ¨λΈ κµ¬ν„κ³Ό λ¬΄κ΄€ν•κ² **API μΈν„°νμ΄μ¤λ¥Ό μ•μ •μ μΌλ΅ μ μ§€**
- μ΄ν›„ λΉ„λ™κΈ° μ²λ¦¬ κµ¬μ΅°λ΅ ν™•μ¥ κ°€λ¥ν• **μ„λΉ„μ¤ μ§„μ…μ (API Gateway μ—­ν• )**

μ¦‰, `api/`λ”  
> **AI λ¨λΈμ„ κ°μ‹Έλ” μ„λΉ„μ¤ κ³„μΈµ(Service Layer)** μ΄λ©°,  
> ν”„λ΅μ νΈ μ „μ²΄μ—μ„ β€μ™Έλ¶€μ™€ μ§μ ‘ ν†µμ‹ ν•λ” AI μ„λ²„β€ μ—­ν• μ„ μν–‰ν•λ‹¤.

---

## π§± μ„¤κ³„ κ΄€μ μ—μ„μ μ„μΉ

ν”„λ΅μ νΈ μ „μ²΄ κµ¬μ΅°μ—μ„ `api/`λ” λ‹¤μκ³Ό κ°™μ€ μ„μΉλ¥Ό κ°€μ§„λ‹¤.

- **μ…λ ¥**: μ΄λ―Έμ§€/μμƒ λ¶„μ„ μ”μ²­
- **μ²λ¦¬**: AI μ¶”λ΅  (ν„μ¬λ” Stub, μ΄ν›„ μ‹¤μ  λ¨λΈ)
- **μ¶λ ¥**: μ„ν—λ„, μ°μ„ μμ„, κ°μ²΄ μ •λ³΄, ν…μ¤νΈ μ„¤λ…

AI λ¨λΈ μμ²΄(YOLO, BLIP λ“±)λ” κµμ²΄ κ°€λ¥ν•μ§€λ§,  
`api/`κ°€ μ κ³µν•λ” **μ”μ²­/μ‘λ‹µ κµ¬μ΅°(API Contract)** λ” μ μ§€λλ” κ²ƒμ„ μ „μ λ΅ ν•λ‹¤.

---

## π“ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```text
api/
β”β”€ app/
β”‚  β”β”€ ai/
β”‚  β”‚  β”β”€ homography.py      # homography λ¨λ“
β”‚  β”‚  β””β”€ pipeline.py        # ai model pipeline
β”‚  β”β”€ celery/
β”‚  β”‚  β”β”€ app.py             # celery worker μ—”νΈλ¦¬ν¬μΈνΈ
β”‚  β”‚  β”β”€ signal.py          # worker pipeline μƒμ„± μ„ν• cfg μ „λ‹¬
β”‚  β”‚  β”β”€ task.py            # worker analyze task
β”‚  β”‚  β””β”€ worker_state.py    # worker λ‚΄λ¶€ state
β”‚  β”β”€ infra/
β”‚  β”‚  β”β”€ config.py          # pipeline_config.json read
β”‚  β”‚  β”β”€ db.py              # db λ¨λ“
β”‚  β”‚  β””β”€ storage.py         # file storage λ¨λ“
β”‚  β”β”€ main.py               # FastAPI μ—”νΈλ¦¬ν¬μΈνΈ
β”‚  β”β”€ schemas.py            # μ”μ²­/μ‘λ‹µ λ°μ΄ν„° λ¨λΈ (API Contract)
β”‚  β”β”€ stub_data.py          # AI μ—°λ™ μ „ λ‹¨κ³„μ μ„μ‹ μ¶”λ΅  λ΅μ§
β”‚  β””β”€ test_homography.py    # homography κΈ°λ¥ test
β”β”€ scripts/
β”‚  β”β”€ run_api               # api μ„λ²„ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β”‚  β”β”€ run_locust            # locust μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β”‚  β””β”€ run_worker            # celery worker μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β”β”€ .venv/                   # λ΅μ»¬ κ°λ°μ© Python κ°€μƒν™κ²½
β”β”€ locustfile.py            # locust μ½”λ“
β”β”€ pipeline_config.json     # pipeline μƒμ„± μ‹ μ„¤μ •
β”β”€ requirements.txt         # ν”„λ΅μ νΈ μμ΅΄μ„± λ©λ΅
β”β”€ yolov8n.py               # YOLOv8 nano checkpoint
β””β”€ README.md